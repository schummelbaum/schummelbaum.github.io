<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>VoiceNote - Fast Notes and Emails, Spoken</title>
    <link href="VoiceNote.ico" rel="icon" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#FF3B30",
                        "primary-hover": "#D93026",
                        "background-light": "#F3F4F6",
                        "background-dark": "#121212",
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#1E1E1E",
                        "surface-darker": "#181818",
                        "border-light": "#E5E7EB",
                        "border-dark": "#333333",
                    },
                    fontFamily: {
                        display: ["Inter", "sans-serif"],
                        body: ["Inter", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                        'xl': "0.75rem",
                        '2xl': "1rem",
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(255, 59, 48, 0.3)',
                        'glow-sm': '0 0 10px rgba(255, 59, 48, 0.2)',
                    }
                },
            },
        };
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .waveform-bar {
            animation: waveform 1s ease-in-out infinite;
        }

        @keyframes waveform {

            0%,
            100% {
                height: 20%;
            }

            50% {
                height: 100%;
            }
        }

        .waveform-bar:nth-child(odd) {
            animation-duration: 0.8s;
        }

        .waveform-bar:nth-child(even) {
            animation-duration: 1.2s;
        }

        .glass-panel {
            background: rgba(30, 30, 30, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .light .glass-panel {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 300,
                'GRAD' 0,
                'opsz' 24
        }

        .hero-grid-pattern {
            position: absolute;
            inset: 0;
            pointer-events: none;
            background-image:
                linear-gradient(rgba(100, 116, 139, 0.18) 1px, transparent 1px),
                linear-gradient(90deg, rgba(100, 116, 139, 0.18) 1px, transparent 1px);
            background-size: 34px 34px;
            -webkit-mask-image: radial-gradient(circle at 50% 20%, rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.35) 68%, transparent 100%);
            mask-image: radial-gradient(circle at 50% 20%, rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.35) 68%, transparent 100%);
        }

        .dark .hero-grid-pattern {
            background-image:
                linear-gradient(rgba(148, 163, 184, 0.14) 1px, transparent 1px),
                linear-gradient(90deg, rgba(148, 163, 184, 0.14) 1px, transparent 1px);
        }

        .vn-preview-shell {
            position: relative;
            text-align: left;
        }

        .vn-preview-stage {
            position: relative;
            width: min(100%, 420px);
            min-height: 720px;
            margin: 0 auto;
            padding-bottom: 130px;
            text-align: left;
        }

        .vn-app-window {
            position: relative;
            width: min(100%, 320px);
            height: 560px;
            margin: 0 auto;
            z-index: 2;
        }

        .vn-app-shell {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 14px;
            border: 1px solid rgba(58, 58, 58, 0.92);
            background: #202020;
            overflow: hidden;
            box-shadow:
                0 24px 48px rgba(0, 0, 0, 0.45),
                inset 0 0 0 1px rgba(255, 255, 255, 0.03);
        }

        .vn-main-panel {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .vn-gear-button {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.06);
            color: #9ca3af;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 7;
        }

        .vn-gear-button:hover {
            background: rgba(255, 255, 255, 0.12);
            color: #ffffff;
        }

        .vn-mic-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-top: 28px;
            padding-bottom: 8px;
        }

        .vn-mic-button {
            position: relative;
            width: 76px;
            height: 76px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.10);
            background: #3a3a3a;
            color: #ef4444;
            box-shadow: 0 12px 22px rgba(0, 0, 0, 0.35);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 120ms ease, background 120ms ease, border-color 120ms ease, color 120ms ease;
        }

        .vn-mic-button::before {
            content: "";
            position: absolute;
            inset: -12px;
            border-radius: 999px;
            background: rgba(239, 68, 68, 0.26);
            opacity: 0;
            transform: scale(0.8);
            pointer-events: none;
        }

        .vn-mic-button:hover {
            transform: scale(1.04);
            border-color: rgba(239, 68, 68, 0.24);
            background: #444444;
        }

        .vn-mic-icon {
            position: absolute;
            font-size: 32px;
            line-height: 1;
            opacity: 0;
            transition: opacity 120ms ease;
        }

        .vn-mic-spinner {
            position: absolute;
            width: 36px;
            height: 36px;
            display: none;
            pointer-events: none;
            --vn-spinner-r: 203, 213, 225;
            --vn-spinner-spoke-width: 2.8px;
            --vn-spinner-spoke-height: 10px;
            --vn-spinner-spoke-top: 2px;
            --vn-spinner-spoke-left: 16.6px;
            --vn-spinner-spoke-origin: 16px;
        }

        .vn-recording-label {
            margin: 10px 0 0;
            font-size: 12px;
            font-weight: 500;
            color: #7f858c;
            letter-spacing: 0.2px;
            line-height: 1.1;
        }

        .vn-history-section {
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 2px 5px 12px 12px;
        }

        .vn-history-header {
            min-height: 30px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #c7c7c7;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.6px;
            text-transform: uppercase;
        }

        .vn-history-list {
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 0 5px 2px 0;
            margin-right: -5px;
        }

        .vn-history-card {
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(45, 45, 45, 0.55);
            box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.03);
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .vn-history-card.is-recent {
            border-color: rgba(239, 68, 68, 0.4);
            box-shadow:
                inset 0 0 0 1px rgba(239, 68, 68, 0.14),
                0 10px 18px rgba(0, 0, 0, 0.18);
        }

        .vn-history-card-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .vn-history-time {
            font-size: 11px;
            color: #7f858c;
            font-weight: 600;
        }

        .vn-history-actions {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .vn-history-action {
            width: 26px;
            height: 26px;
            border-radius: 6px;
            border: 1px solid transparent;
            background: transparent;
            color: #8f96a1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0;
            transition: background 140ms ease, color 140ms ease, border-color 140ms ease;
        }

        .vn-history-action .material-symbols-outlined {
            font-size: 16px;
            line-height: 1;
        }

        .vn-history-action:hover {
            color: #e5e7eb;
            background: rgba(255, 255, 255, 0.08);
        }

        .vn-history-action:focus-visible {
            outline: none;
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.14);
        }

        .vn-history-action--delete:hover {
            color: #fda4af;
            background: rgba(239, 68, 68, 0.18);
        }

        .vn-history-action--copy.is-copied {
            color: #fecaca;
            background: rgba(239, 68, 68, 0.22);
            border-color: rgba(239, 68, 68, 0.45);
        }

        .vn-history-text {
            margin: 0;
            font-size: 13px;
            line-height: 1.35;
            color: #a3a8af;
            min-height: calc(1.35em * 2);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-align: left;
        }

        .vn-settings-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.32);
            opacity: 0;
            pointer-events: none;
            transition: opacity 160ms ease;
            z-index: 4;
        }

        .vn-settings-sidebar {
            width: 250px;
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            transform: translateX(104%);
            transition: transform 180ms ease;
            background: rgba(25, 25, 25, 0.76);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.05);
            z-index: 5;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .vn-settings-header {
            min-height: 58px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .vn-settings-title {
            margin: 0;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            font-weight: 600;
            color: #c7c7c7;
            letter-spacing: 0.6px;
            text-transform: uppercase;
        }

        .vn-settings-close {
            border: 1px solid rgba(255, 255, 255, 0.08);
            background: rgba(255, 255, 255, 0.06);
            color: #bfc5cc;
            border-radius: 6px;
            padding: 6px 8px;
            width: 28px;
            height: 28px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .vn-settings-close:hover {
            background: rgba(255, 255, 255, 0.12);
            color: #ffffff;
        }

        .vn-settings-list {
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .vn-setting-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.04);
        }

        .vn-setting-title {
            font-size: 12px;
            font-weight: 600;
            color: #d1d5db;
            line-height: 1.2;
        }

        .vn-setting-help {
            font-size: 11px;
            color: #8a9098;
            line-height: 1.3;
        }

        .vn-setting-field {
            min-height: 34px;
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: 6px;
            background: rgba(20, 20, 20, 0.45);
            color: #e5e7eb;
            font-size: 12px;
            padding: 0 10px;
            display: inline-flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            text-align: left;
            user-select: none;
        }

        .vn-setting-copy {
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .vn-setting-title,
        .vn-setting-help {
            text-align: left;
        }

        .vn-setting-combo {
            position: relative;
        }

        .vn-setting-combo-button {
            width: 100%;
            min-height: 34px;
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: 6px;
            background: rgba(20, 20, 20, 0.45);
            color: #e5e7eb;
            font-size: 12px;
            padding: 0 10px;
            display: inline-flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            cursor: pointer;
            outline: none;
            text-align: left;
        }

        .vn-setting-combo-button:hover {
            background: rgba(30, 30, 30, 0.58);
        }

        .vn-setting-combo-button:focus-visible,
        .vn-setting-combo.open .vn-setting-combo-button {
            border-color: rgba(239, 68, 68, 0.45);
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.14);
        }

        .vn-setting-combo-button .material-symbols-outlined {
            font-size: 18px;
            color: #9ca3af;
        }

        .vn-setting-combo-menu {
            position: absolute;
            top: calc(100% + 6px);
            left: 0;
            right: 0;
            border: 1px solid rgba(255, 255, 255, 0.14);
            border-radius: 8px;
            background: #2d2d2d;
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.45);
            padding: 6px;
            display: none;
            z-index: 80;
            max-height: 220px;
            overflow-y: auto;
            overscroll-behavior: contain;
        }

        .vn-setting-combo.open .vn-setting-combo-menu {
            display: block;
        }

        .vn-setting-combo-option {
            width: 100%;
            border: none;
            background: #2d2d2d;
            color: #d1d5db;
            font-size: 12px;
            min-height: 30px;
            padding: 0 8px;
            text-align: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            border-radius: 6px;
            cursor: pointer;
        }

        .vn-setting-combo-option:hover,
        .vn-setting-combo-option:focus-visible {
            outline: none;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .vn-setting-combo-option.is-selected {
            background: rgba(239, 68, 68, 0.2);
            color: #fecaca;
        }

        .vn-setting-toggle {
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        .vn-setting-switch {
            position: relative;
            width: 42px;
            height: 24px;
            flex-shrink: 0;
            cursor: pointer;
        }

        .vn-setting-switch input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .vn-setting-switch-slider {
            position: absolute;
            inset: 0;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.18);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: background 120ms ease, border-color 120ms ease;
        }

        .vn-setting-switch-slider::before {
            content: "";
            position: absolute;
            left: 3px;
            top: 3px;
            width: 16px;
            height: 16px;
            border-radius: 999px;
            background: #e5e7eb;
            transition: transform 120ms ease;
        }

        .vn-setting-switch input:checked+.vn-setting-switch-slider {
            background: rgba(239, 68, 68, 0.36);
            border-color: rgba(239, 68, 68, 0.55);
        }

        .vn-setting-switch input:checked+.vn-setting-switch-slider::before {
            transform: translateX(18px);
        }

        .vn-setting-switch input:focus-visible+.vn-setting-switch-slider {
            box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.16);
        }

        .vn-flyout-frame {
            position: absolute;
            left: 50%;
            bottom: 32px;
            width: 151px;
            height: 46px;
            transform: translateX(-50%);
            transition: width 190ms cubic-bezier(0.22, 1, 0.36, 1);
            z-index: 3;
        }

        .vn-flyout-pill {
            position: absolute;
            inset: 8px;
            border-radius: 17px;
            border: 1px solid #3a3a3a;
            background: #292929;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 0 5px;
            box-shadow:
                inset 0 0 0 1px rgba(255, 255, 255, 0.03),
                0 12px 20px rgba(0, 0, 0, 0.22),
                0 5px 8px rgba(0, 0, 0, 0.3);
            transition: background 160ms ease, border-color 160ms ease, padding 160ms ease;
        }

        .vn-fly-btn {
            width: 20px;
            height: 20px;
            border-radius: 999px;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            flex-shrink: 0;
            cursor: pointer;
        }

        .vn-fly-btn .material-symbols-outlined {
            font-size: 14px;
            line-height: 1;
        }

        .vn-fly-btn-close {
            background: rgba(255, 255, 255, 0.14);
            color: rgba(236, 236, 236, 0.86);
        }

        .vn-fly-btn-finish {
            background: rgba(248, 83, 83, 0.38);
            border-color: rgba(248, 83, 83, 0.78);
            color: rgba(255, 255, 255, 0.95);
        }

        .vn-fly-wave {
            width: 46px;
            height: 16px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            flex-shrink: 0;
        }

        .vn-fly-wave-bar {
            width: 2px;
            height: 2px;
            border-radius: 1.2px;
            background: rgba(174, 174, 174, 0.55);
            flex-shrink: 0;
        }

        .vn-fly-timer {
            width: 24px;
            text-align: center;
            font-family: Cambria, "Times New Roman", serif;
            font-size: 12px;
            font-weight: 600;
            line-height: 1;
            color: rgba(205, 205, 205, 0.74);
            letter-spacing: 0;
            flex-shrink: 0;
        }

        .vn-fly-spinner {
            width: 22px;
            height: 22px;
            position: relative;
            display: none;
            flex-shrink: 0;
            --vn-spinner-r: 203, 213, 225;
            --vn-spinner-spoke-width: 2.2px;
            --vn-spinner-spoke-height: 6px;
            --vn-spinner-spoke-top: 2px;
            --vn-spinner-spoke-left: 9.9px;
            --vn-spinner-spoke-origin: 9px;
        }

        .vn-mic-spinner span,
        .vn-fly-spinner span {
            position: absolute;
            top: var(--vn-spinner-spoke-top);
            left: var(--vn-spinner-spoke-left);
            width: var(--vn-spinner-spoke-width);
            height: var(--vn-spinner-spoke-height);
            border-radius: 999px;
            background: rgba(var(--vn-spinner-r), 0.20);
            transform-origin: 50% var(--vn-spinner-spoke-origin);
            opacity: 1;
            box-shadow: none;
        }

        .vn-mic-spinner span:nth-child(1),
        .vn-fly-spinner span:nth-child(1) {
            transform: rotate(0deg);
        }

        .vn-mic-spinner span:nth-child(2),
        .vn-fly-spinner span:nth-child(2) {
            transform: rotate(45deg);
        }

        .vn-mic-spinner span:nth-child(3),
        .vn-fly-spinner span:nth-child(3) {
            transform: rotate(90deg);
        }

        .vn-mic-spinner span:nth-child(4),
        .vn-fly-spinner span:nth-child(4) {
            transform: rotate(135deg);
        }

        .vn-mic-spinner span:nth-child(5),
        .vn-fly-spinner span:nth-child(5) {
            transform: rotate(180deg);
        }

        .vn-mic-spinner span:nth-child(6),
        .vn-fly-spinner span:nth-child(6) {
            transform: rotate(225deg);
        }

        .vn-mic-spinner span:nth-child(7),
        .vn-fly-spinner span:nth-child(7) {
            transform: rotate(270deg);
        }

        .vn-mic-spinner span:nth-child(8),
        .vn-fly-spinner span:nth-child(8) {
            transform: rotate(315deg);
        }

        .vn-settings-list::-webkit-scrollbar,
        .vn-history-list::-webkit-scrollbar,
        .vn-setting-combo-menu::-webkit-scrollbar {
            width: 4px;
        }

        .vn-settings-list,
        .vn-history-list,
        .vn-setting-combo-menu {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.24) transparent;
        }

        .vn-settings-list::-webkit-scrollbar-track,
        .vn-history-list::-webkit-scrollbar-track,
        .vn-setting-combo-menu::-webkit-scrollbar-track {
            background: transparent;
        }

        .vn-settings-list::-webkit-scrollbar-thumb,
        .vn-history-list::-webkit-scrollbar-thumb,
        .vn-setting-combo-menu::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.14);
            border-radius: 12px;
        }

        .vn-settings-list::-webkit-scrollbar-thumb:hover,
        .vn-history-list::-webkit-scrollbar-thumb:hover,
        .vn-setting-combo-menu::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.24);
        }

        #vn-realistic-preview[data-state="idle"] .vn-mic-idle {
            opacity: 1;
        }

        #vn-realistic-preview[data-state="listening"] .vn-mic-listening {
            opacity: 1;
        }

        #vn-realistic-preview[data-state="listening"] .vn-mic-button {
            border-color: rgba(239, 68, 68, 0.46);
            background: #442626;
            color: #f87171;
        }

        #vn-realistic-preview[data-state="listening"] .vn-mic-button::before {
            animation: vn-mic-ring 1.25s ease-out infinite;
        }

        #vn-realistic-preview[data-state="listening"] .vn-recording-label,
        #vn-realistic-preview[data-state="listening"] .vn-fly-timer {
            color: rgba(248, 86, 86, 0.98);
        }

        #vn-realistic-preview[data-state="listening"] .vn-fly-wave-bar {
            background: rgba(248, 86, 86, 0.92);
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-mic-button {
            border-color: rgba(148, 163, 184, 0.34);
            background: #303640;
            color: #dbe4ef;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-mic-spinner {
            display: block;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-recording-label {
            color: #dbe4ef;
            animation: vn-processing-pulse 1s ease-in-out infinite;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-flyout-frame {
            width: 98px;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-flyout-pill {
            background: #282b30;
            border-color: #474e57;
            padding-left: 6px;
            padding-right: 5px;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-fly-btn-close,
        #vn-realistic-preview[data-state="transcribing"] .vn-fly-timer,
        #vn-realistic-preview[data-state="transcribing"] .vn-fly-btn-finish {
            display: none;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-fly-spinner {
            display: block;
        }

        #vn-realistic-preview[data-state="transcribing"] .vn-fly-wave-bar {
            background: rgba(219, 228, 239, 0.95);
        }

        #vn-realistic-preview.is-settings-open .vn-settings-sidebar {
            transform: translateX(0);
        }

        #vn-realistic-preview.is-settings-open .vn-settings-overlay {
            opacity: 1;
            pointer-events: auto;
        }

        @keyframes vn-mic-ring {
            0% {
                opacity: 0.5;
                transform: scale(0.82);
            }

            70% {
                opacity: 0.08;
                transform: scale(1.2);
            }

            100% {
                opacity: 0;
                transform: scale(1.25);
            }
        }

        @keyframes vn-processing-pulse {
            0% {
                opacity: 0.55;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.55;
            }
        }

        @media (max-width: 720px) {
            .vn-preview-stage {
                width: min(100%, 336px);
                min-height: 690px;
                padding-bottom: 116px;
            }

            .vn-app-window {
                width: min(100%, 308px);
            }
        }

        /* Context Panel Styles */
        .vn-preview-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            position: relative;
            max-width: 900px;
            margin: 0 auto;
        }

        @media (max-width: 1024px) {
            .vn-preview-wrapper {
                flex-direction: column;
                gap: 40px;
            }
        }

        .vn-context-panel {
            width: 380px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
            min-height: 400px;
            padding: 20px 0;
            margin-top: -160px;
            /* Raised significantly higher */
        }

        .vn-context-content-wrapper {
            position: relative;
            flex: 1;
            width: 100%;
            margin-top: 40px;
            /* Adjusted spacing */
        }

        .vn-context-item {
            position: absolute;
            top: 40%;
            /* Moved up slightly */
            left: 0;
            right: 0;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            gap: 24px;
            /* Increased gap to push description down relative to divider */
        }

        .vn-context-item.is-active {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(-50%);
        }

        .vn-context-title {
            font-size: 48px;
            /* Increased */
            font-weight: 800;
            line-height: 1.05;
            letter-spacing: -0.02em;
            background: linear-gradient(to bottom, #1f2937, #4b5563);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0;
            /* Removed margin to compact */
            position: relative;
        }

        .vn-context-title::after {
            content: '';
            display: block;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, #EF4444, transparent);
            margin-top: 12px;
            /* Closer to text (upper third) */
            border-radius: 2px;
            opacity: 0.8;
        }

        .dark .vn-context-title::after {
            background: linear-gradient(to right, #EF4444, transparent);
        }

        .dark .vn-context-title {
            background: linear-gradient(to bottom, #ffffff, #9ca3af);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .vn-context-text {
            font-size: 18px;
            /* Increased from 16px */
            line-height: 1.6;
            color: #4b5563;
        }

        .dark .vn-context-text {
            color: #9ca3af;
        }

        .vn-context-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 6px;
            background: #e2e8f0;
            color: #475569;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            width: fit-content;
        }

        .dark .vn-context-tag {
            background: #2d2d2d;
            color: #94a3b8;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Demo Controls */
        .vn-demo-toggle {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            background: transparent;
            color: #6b7280;
        }

        .dark .vn-demo-toggle {
            color: #9ca3af;
        }

        .vn-demo-toggle:hover {
            background: rgba(0, 0, 0, 0.05);
            color: #111827;
        }

        .dark .vn-demo-toggle:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
        }

        .vn-demo-toggle.is-active {
            background: #fff;
            color: #ef4444;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border-color: #e5e7eb;
        }

        .dark .vn-demo-toggle.is-active {
            background: #2d2d2d;
            color: #ef4444;
            border-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Flyout Mode Specifics */
        #vn-realistic-preview[data-context="flyout"] .vn-app-shell {
            opacity: 0.4;
            filter: grayscale(1);
            transform: scale(0.98);
            transition: all 0.4s ease;
            pointer-events: none;
        }

        #vn-realistic-preview .vn-app-shell {
            transition: all 0.4s ease;
        }

        #vn-realistic-preview[data-context="flyout"] .vn-flyout-frame {
            animation: vn-flyout-pop 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 1;
            filter: none;
            transform: translateX(-50%) scale(1);
        }

        /* Diabled Flyout State */
        #vn-realistic-preview[data-context="app"] .vn-flyout-frame {
            opacity: 0.3;
            filter: blur(1px) grayscale(0.8);
            transform: translateX(-50%) scale(0.95);
            transition: all 0.5s ease;
        }

        /* Disable interactions when in App mode */
        #vn-realistic-preview[data-context="app"] .vn-flyout-pill {
            pointer-events: none;
        }

        @keyframes vn-flyout-pop {
            0% {
                transform: translate(-50%, 20px) scale(0.9);
                opacity: 0;
            }

            100% {
                transform: translate(-50%, 0) scale(1);
                opacity: 1;
            }
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <nav class="fixed top-0 w-full z-50 border-b border-border-light dark:border-border-dark glass-panel">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <img alt="VoiceNote logo"
                        class="w-8 h-8 rounded-lg border border-gray-600 shadow-glow-sm object-cover"
                        src="VoiceNote.ico" />
                    <span class="font-bold text-xl tracking-tight">VoiceNote</span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <a class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors text-sm font-medium"
                        href="#preview">Preview</a>
                    <a class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors text-sm font-medium"
                        href="#features">Features</a>
                    <a class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors text-sm font-medium"
                        href="#workflow">Workflow</a>
                    <a class="text-gray-600 dark:text-gray-400 hover:text-primary dark:hover:text-primary transition-colors text-sm font-medium"
                        href="#faq">FAQ</a>
                </div>
                <div class="md:hidden flex items-center">
                    <button
                        class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    <section class="pt-32 pb-20 overflow-hidden relative">
        <div class="hero-grid-pattern"></div>
        <div
            class="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[500px] bg-primary opacity-5 dark:opacity-10 blur-[120px] rounded-full -z-10 pointer-events-none">
        </div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
            <div
                class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-500/10 border border-emerald-500/30 text-emerald-500 dark:text-emerald-400 text-xs font-semibold uppercase tracking-wider mb-6">
                <span class="w-2 h-2 rounded-full bg-emerald-500 dark:bg-emerald-400 animate-pulse"></span>
                Just Released
            </div>
            <h1
                class="text-5xl md:text-7xl font-bold tracking-tight mb-6 bg-clip-text text-transparent bg-gradient-to-b from-gray-900 to-gray-600 dark:from-white dark:to-gray-400">
                Take Notes and Draft Emails<br />by <span class="text-primary relative inline-block">
                    Speaking
                    <svg class="absolute -bottom-2 w-full h-3 text-primary opacity-40" preserveAspectRatio="none"
                        viewBox="0 0 100 10">
                        <path d="M0 5 Q 50 10 100 5" fill="none" stroke="currentColor" stroke-width="4"></path>
                    </svg>
                </span>
            </h1>
            <p class="text-xl text-gray-600 dark:text-gray-400 max-w-2xl mx-auto mb-10 leading-relaxed">
                Capture notes, emails, and ideas in seconds. VoiceNote turns speech into ready-to-use text anywhere in
                Windows 11.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-16">
                <a class="bg-primary hover:bg-primary-hover text-white px-8 py-3.5 rounded-xl font-semibold transition-all shadow-glow hover:shadow-lg flex items-center gap-2 group"
                    href="https://github.com/schummelbaum/VoiceNote-builds/releases/latest" id="download-windows-btn"
                    rel="noopener noreferrer">
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" height="1em" stroke="currentColor"
                        stroke-width="0" viewBox="0 0 448 512" width="1em" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M0 93.7l183.6-25.3v177.4H0V93.7zm0 324.6l183.6 25.3V268.4H0v149.9zm203.8 28L448 480V268.4H203.8v177.9zm0-380.6L448 32v214.9H203.8V65.7z">
                        </path>
                    </svg>
                    Download for Windows
                </a>
                <button aria-disabled="true"
                    class="border border-dashed border-gray-400 bg-transparent hover:bg-gray-50/10 text-gray-400 px-8 py-3.5 rounded-xl font-semibold transition-all flex items-center gap-2 opacity-60 hover:opacity-100 pointer-events-none"
                    tabindex="-1" type="button">
                    <i class="fa-brands fa-apple text-lg"></i>
                    macOS — Soon
                </button>
            </div>
            <div class="vn-preview-shell max-w-7xl mx-auto mt-12 scroll-mt-32" id="preview">
                <div class="vn-preview-wrapper">
                    <div class="vn-preview-stage" data-state="idle" id="vn-realistic-preview">
                        <div class="vn-app-window">
                            <div class="vn-app-shell">
                                <aside class="vn-settings-sidebar">
                                    <div class="vn-settings-header">
                                        <h3 class="vn-settings-title">
                                            <span class="material-symbols-outlined">settings</span>
                                            Settings
                                        </h3>
                                        <button class="vn-settings-close" id="vn-settings-close-button" type="button">
                                            <span class="material-symbols-outlined">close</span>
                                        </button>
                                    </div>
                                    <div class="vn-settings-list">
                                        <div class="vn-setting-item">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Transcription Language</div>
                                                <div class="vn-setting-help">Use Auto-detect for mixed speech.</div>
                                            </div>
                                            <div class="vn-setting-combo" id="vn-setting-language-combo">
                                                <button aria-expanded="false" aria-haspopup="listbox"
                                                    class="vn-setting-combo-button" id="vn-setting-language-button"
                                                    type="button">
                                                    <span id="vn-setting-language-value">Auto-detect</span>
                                                    <span class="material-symbols-outlined">expand_more</span>
                                                </button>
                                                <div aria-label="Transcription language" class="vn-setting-combo-menu"
                                                    id="vn-setting-language-menu" role="listbox">
                                                    <button class="vn-setting-combo-option is-selected"
                                                        data-value="auto" type="button">Auto-detect</button>
                                                    <button class="vn-setting-combo-option" data-value="en"
                                                        type="button">English</button>
                                                    <button class="vn-setting-combo-option" data-value="de"
                                                        type="button">German</button>
                                                    <button class="vn-setting-combo-option" data-value="es"
                                                        type="button">Spanish</button>
                                                    <button class="vn-setting-combo-option" data-value="fr"
                                                        type="button">French</button>
                                                    <button class="vn-setting-combo-option" data-value="ja"
                                                        type="button">Japanese</button>
                                                    <button class="vn-setting-combo-option" data-value="ko"
                                                        type="button">Korean</button>
                                                    <button class="vn-setting-combo-option" data-value="pt"
                                                        type="button">Portuguese</button>
                                                    <button class="vn-setting-combo-option" data-value="ru"
                                                        type="button">Russian</button>
                                                    <button class="vn-setting-combo-option" data-value="tr"
                                                        type="button">Turkish</button>
                                                    <button class="vn-setting-combo-option" data-value="vi"
                                                        type="button">Vietnamese</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="vn-setting-item">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Whisper Model</div>
                                                <div class="vn-setting-help">Small models are faster, large are more
                                                    accurate.</div>
                                            </div>
                                            <div class="vn-setting-combo" id="vn-setting-model-combo">
                                                <button aria-expanded="false" aria-haspopup="listbox"
                                                    class="vn-setting-combo-button" id="vn-setting-model-button"
                                                    type="button">
                                                    <span id="vn-setting-model-value">Tiny</span>
                                                    <span class="material-symbols-outlined">expand_more</span>
                                                </button>
                                                <div aria-label="Whisper model" class="vn-setting-combo-menu"
                                                    id="vn-setting-model-menu" role="listbox">
                                                    <button class="vn-setting-combo-option is-selected"
                                                        data-value="tiny" type="button">Tiny</button>
                                                    <button class="vn-setting-combo-option" data-value="base"
                                                        type="button">Base</button>
                                                    <button class="vn-setting-combo-option" data-value="small"
                                                        type="button">Small</button>
                                                    <button class="vn-setting-combo-option" data-value="medium"
                                                        type="button">Medium</button>
                                                    <button class="vn-setting-combo-option" data-value="large-v3"
                                                        type="button">Large</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="vn-setting-item">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Action On Close</div>
                                                <div class="vn-setting-help">Choose what happens when the close button
                                                    is clicked.</div>
                                            </div>
                                            <div class="vn-setting-combo" id="vn-setting-close-action-combo">
                                                <button aria-expanded="false" aria-haspopup="listbox"
                                                    class="vn-setting-combo-button" id="vn-setting-close-action-button"
                                                    type="button">
                                                    <span id="vn-setting-close-action-value">Keep system tray</span>
                                                    <span class="material-symbols-outlined">expand_more</span>
                                                </button>
                                                <div aria-label="Action on close" class="vn-setting-combo-menu"
                                                    id="vn-setting-close-action-menu" role="listbox">
                                                    <button class="vn-setting-combo-option is-selected"
                                                        data-value="tray" type="button">Keep system tray</button>
                                                    <button class="vn-setting-combo-option" data-value="close"
                                                        type="button">Close</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="vn-setting-item">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Flyout Hotkey</div>
                                                <div class="vn-setting-help">Shortcut used to open VoiceNote flyout.
                                                </div>
                                            </div>
                                            <div class="vn-setting-field">
                                                <span>Ctrl + Space</span>
                                            </div>
                                        </div>
                                        <label class="vn-setting-item vn-setting-toggle" for="vn-setting-keep-on-top">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Keep Window On Top</div>
                                                <div class="vn-setting-help">Keep VoiceNote above other windows.</div>
                                            </div>
                                            <span class="vn-setting-switch">
                                                <input id="vn-setting-keep-on-top" type="checkbox" />
                                                <span aria-hidden="true" class="vn-setting-switch-slider"></span>
                                            </span>
                                        </label>
                                        <label class="vn-setting-item vn-setting-toggle"
                                            for="vn-setting-start-at-login">
                                            <div class="vn-setting-copy">
                                                <div class="vn-setting-title">Start VoiceNote At Login</div>
                                                <div class="vn-setting-help">Launch VoiceNote when Windows starts.</div>
                                            </div>
                                            <span class="vn-setting-switch">
                                                <input checked="" id="vn-setting-start-at-login" type="checkbox" />
                                                <span aria-hidden="true" class="vn-setting-switch-slider"></span>
                                            </span>
                                        </label>
                                    </div>
                                </aside>
                                <div class="vn-settings-overlay" id="vn-settings-overlay"></div>
                                <section class="vn-main-panel">
                                    <button class="vn-gear-button" id="vn-app-settings-button" type="button">
                                        <span class="material-symbols-outlined">settings</span>
                                    </button>
                                    <header class="vn-mic-header">
                                        <button class="vn-mic-button" id="vn-preview-mic-button" type="button">
                                            <span class="material-symbols-outlined vn-mic-icon vn-mic-idle">mic</span>
                                            <span
                                                class="material-symbols-outlined vn-mic-icon vn-mic-listening">stop</span>
                                            <span aria-hidden="true" class="vn-mic-spinner">
                                                <span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span>
                                            </span>
                                        </button>
                                        <p class="vn-recording-label" id="vn-preview-recording-label">Tap to record</p>
                                    </header>
                                    <section class="vn-history-section">
                                        <div class="vn-history-header">
                                            <span class="material-symbols-outlined">history</span>
                                            <span>History</span>
                                        </div>
                                        <div class="vn-history-list" id="vn-history-list">
                                            <article class="vn-history-card is-recent">
                                                <div class="vn-history-card-top">
                                                    <span class="vn-history-time">Just now</span>
                                                    <span class="vn-history-actions">
                                                        <button aria-label="Edit entry"
                                                            class="vn-history-action vn-history-action--edit"
                                                            title="Edit entry" type="button">
                                                            <span class="material-symbols-outlined">edit</span>
                                                        </button>
                                                        <button aria-label="Delete entry"
                                                            class="vn-history-action vn-history-action--delete"
                                                            title="Delete entry" type="button">
                                                            <span class="material-symbols-outlined">delete</span>
                                                        </button>
                                                        <button aria-label="Copy entry"
                                                            class="vn-history-action vn-history-action--copy"
                                                            title="Copy entry" type="button">
                                                            <span class="material-symbols-outlined">content_copy</span>
                                                        </button>
                                                    </span>
                                                </div>
                                                <p class="vn-history-text">Hey Josh, thanks for your email today. I
                                                    reviewed the proposal and will send feedback tomorrow.</p>
                                            </article>
                                            <article class="vn-history-card">
                                                <div class="vn-history-card-top">
                                                    <span class="vn-history-time">2 mins ago</span>
                                                    <span class="vn-history-actions">
                                                        <button aria-label="Edit entry"
                                                            class="vn-history-action vn-history-action--edit"
                                                            title="Edit entry" type="button">
                                                            <span class="material-symbols-outlined">edit</span>
                                                        </button>
                                                        <button aria-label="Delete entry"
                                                            class="vn-history-action vn-history-action--delete"
                                                            title="Delete entry" type="button">
                                                            <span class="material-symbols-outlined">delete</span>
                                                        </button>
                                                        <button aria-label="Copy entry"
                                                            class="vn-history-action vn-history-action--copy"
                                                            title="Copy entry" type="button">
                                                            <span class="material-symbols-outlined">content_copy</span>
                                                        </button>
                                                    </span>
                                                </div>
                                                <p class="vn-history-text">Meeting notes: launch is on track, design
                                                    review moved to Thursday, and Sarah will share final assets.</p>
                                            </article>
                                            <article class="vn-history-card">
                                                <div class="vn-history-card-top">
                                                    <span class="vn-history-time">5 mins ago</span>
                                                    <span class="vn-history-actions">
                                                        <button aria-label="Edit entry"
                                                            class="vn-history-action vn-history-action--edit"
                                                            title="Edit entry" type="button">
                                                            <span class="material-symbols-outlined">edit</span>
                                                        </button>
                                                        <button aria-label="Delete entry"
                                                            class="vn-history-action vn-history-action--delete"
                                                            title="Delete entry" type="button">
                                                            <span class="material-symbols-outlined">delete</span>
                                                        </button>
                                                        <button aria-label="Copy entry"
                                                            class="vn-history-action vn-history-action--copy"
                                                            title="Copy entry" type="button">
                                                            <span class="material-symbols-outlined">content_copy</span>
                                                        </button>
                                                    </span>
                                                </div>
                                                <p class="vn-history-text">Hi team, quick update: QA passed, release is
                                                    scheduled for Friday, and docs are almost finished.</p>
                                            </article>
                                        </div>
                                    </section>
                                </section>
                            </div>
                        </div>
                        <div class="vn-flyout-frame">
                            <div class="vn-flyout-pill">
                                <button class="vn-fly-btn vn-fly-btn-close" id="vn-preview-flyout-discard"
                                    type="button">
                                    <span class="material-symbols-outlined">close</span>
                                </button>
                                <div class="vn-fly-wave">
                                    <span class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span><span
                                        class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span><span
                                        class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span><span
                                        class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span><span
                                        class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span><span
                                        class="vn-fly-wave-bar"></span><span class="vn-fly-wave-bar"></span>
                                </div>
                                <div class="vn-fly-timer" id="vn-preview-flyout-timer">0:00</div>
                                <div aria-hidden="true" class="vn-fly-spinner">
                                    <span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span>
                                </div>
                                <button class="vn-fly-btn vn-fly-btn-finish" id="vn-preview-flyout-finish"
                                    type="button">
                                    <span class="material-symbols-outlined">check</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <aside class="vn-context-panel">
                        <!-- Controls - Moved to Top -->
                        <div class="flex flex-wrap gap-2 mb-4">
                            <button class="vn-demo-toggle is-active" id="vn-demo-app-mode">
                                <span class="material-symbols-outlined text-[18px]">desktop_windows</span>
                                App Mode
                            </button>
                            <button class="vn-demo-toggle" id="vn-demo-flyout-mode">
                                <span class="material-symbols-outlined text-[18px]">filter_none</span>
                                Flyout Mode
                            </button>
                        </div>

                        <div class="vn-context-content-wrapper">
                            <!-- App: Idle -->
                            <div class="vn-context-item is-active" data-context="app" data-state="idle">
                                <h3 class="vn-context-title">Your Voice,<br>Your Notes</h3>
                                <p class="vn-context-text">Ready to capture a thought? Click the microphone and start
                                    dictating notes, emails, and messages instantly.</p>
                            </div>

                            <!-- App: Listening -->
                            <div class="vn-context-item" data-context="app" data-state="listening">
                                <span class="vn-context-tag">
                                    <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                                    Listening
                                </span>
                                <h3 class="vn-context-title text-primary">Go Ahead,<br>Speak Naturally</h3>
                                <p class="vn-context-text">VoiceNote captures your words in real time so you can draft
                                    complete notes or emails without typing.</p>
                            </div>

                            <!-- App: Transcribing -->
                            <div class="vn-context-item" data-context="app" data-state="transcribing">
                                <span class="vn-context-tag">
                                    <span
                                        class="material-symbols-outlined text-[14px] animate-spin">progress_activity</span>
                                    Processing
                                </span>
                                <h3 class="vn-context-title">Turning Speech<br>into Text</h3>
                                <p class="vn-context-text">Our local AI models transcribe your recording quickly and
                                    accurately, ready to paste.</p>
                            </div>

                            <!-- App: Settings -->
                            <div class="vn-context-item" data-context="app" data-state="settings">
                                <h3 class="vn-context-title">Set It Up<br>Your Way</h3>
                                <p class="vn-context-text">Choose your model, language, and behavior settings to match
                                    how you work.</p>
                            </div>

                            <!-- Flyout: Listening -->
                            <div class="vn-context-item" data-context="flyout" data-state="listening">
                                <span class="vn-context-tag">Example Hotkey: Ctrl + Space</span>
                                <h3 class="vn-context-title">Quick Capture<br>Anywhere</h3>
                                <p class="vn-context-text">Open VoiceNote's flyout over any window for instant
                                    dictation without breaking your focus.</p>
                            </div>

                            <!-- Flyout: Transcribing -->
                            <div class="vn-context-item" data-context="flyout" data-state="transcribing">
                                <h3 class="vn-context-title">Instant<br>Insert</h3>
                                <p class="vn-context-text">Your transcription appears exactly where your cursor is in
                                    the active app.</p>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
    </section>
    <section class="py-24 relative overflow-hidden" id="features">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900 dark:text-white">Designed for Fast Capture
                </h2>
                <p class="text-gray-600 dark:text-gray-400 max-w-xl mx-auto">Speak your thoughts once and get clean text
                    ready for notes, emails, and messages.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div
                    class="group bg-white dark:bg-surface-dark p-8 rounded-2xl border border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary transition-colors shadow-sm hover:shadow-glow-sm relative overflow-hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-primary opacity-5 rounded-bl-[100px] pointer-events-none transition-opacity group-hover:opacity-10">
                    </div>
                    <div
                        class="w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center mb-6 text-primary group-hover:scale-110 transition-transform duration-300">
                        <span class="material-symbols-outlined text-2xl">keyboard</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Global Shortcut</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">
                        Open VoiceNote from anywhere in Windows 11 with a customizable hotkey and start dictating right
                        away.
                    </p>
                </div>
                <div
                    class="group bg-white dark:bg-surface-dark p-8 rounded-2xl border border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary transition-colors shadow-sm hover:shadow-glow-sm relative overflow-hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-primary opacity-5 rounded-bl-[100px] pointer-events-none transition-opacity group-hover:opacity-10">
                    </div>
                    <div
                        class="w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center mb-6 text-primary group-hover:scale-110 transition-transform duration-300">
                        <span class="material-symbols-outlined text-2xl">graphic_eq</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Live Waveform</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">
                        Real-time visual feedback makes it clear when VoiceNote is listening, so you can speak with
                        confidence.
                    </p>
                </div>
                <div
                    class="group bg-white dark:bg-surface-dark p-8 rounded-2xl border border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary transition-colors shadow-sm hover:shadow-glow-sm relative overflow-hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-primary opacity-5 rounded-bl-[100px] pointer-events-none transition-opacity group-hover:opacity-10">
                    </div>
                    <div
                        class="w-12 h-12 bg-primary/10 rounded-xl flex items-center justify-center mb-6 text-primary group-hover:scale-110 transition-transform duration-300">
                        <span class="material-symbols-outlined text-2xl">flash_on</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Instant Insert</h3>
                    <p class="text-gray-600 dark:text-gray-400 leading-relaxed">
                        Your transcribed text is pasted directly into your active window. Email clients, chat apps,
                        docs, and forms all work instantly.
                    </p>
                </div>
            </div>
        </div>
    </section>
    <section class="py-24 bg-surface-light dark:bg-[#151515] relative overflow-hidden" id="workflow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-5xl font-bold mb-4 text-gray-900 dark:text-white">Three steps. Start
                    writing faster.</h2>
                <p class="text-gray-600 dark:text-gray-400 text-lg">From idea to polished text in seconds.</p>
            </div>
            <div class="relative max-w-5xl mx-auto">
                <div class="hidden md:block absolute top-[28px] left-20 right-20 h-[1px] bg-border-dark opacity-40 z-0">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-12 relative z-10">
                    <div class="flex flex-col items-center text-center">
                        <div
                            class="w-14 h-14 rounded-2xl bg-surface-darker border border-primary/20 flex items-center justify-center mb-8 relative z-20 shadow-lg">
                            <span class="material-symbols-outlined text-xl text-primary">keyboard</span>
                        </div>
                        <span class="text-xs font-bold text-primary mb-2 uppercase tracking-widest">01</span>
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Press Hotkey</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 leading-relaxed px-4">A compact flyout
                            appears instantly at your cursor, so no app switching is needed.</p>
                    </div>
                    <div class="flex flex-col items-center text-center">
                        <div
                            class="w-14 h-14 rounded-2xl bg-surface-darker border border-primary/20 flex items-center justify-center mb-8 relative z-20 shadow-lg">
                            <span class="material-symbols-outlined text-xl text-primary">mic</span>
                        </div>
                        <span class="text-xs font-bold text-primary mb-2 uppercase tracking-widest">02</span>
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Speak naturally</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 leading-relaxed px-4">See a live waveform
                            and recording timer while you speak naturally at your own pace.</p>
                    </div>
                    <div class="flex flex-col items-center text-center">
                        <div
                            class="w-14 h-14 rounded-2xl bg-surface-darker border border-primary/20 flex items-center justify-center mb-8 relative z-20 shadow-lg">
                            <span class="material-symbols-outlined text-xl text-primary">check</span>
                        </div>
                        <span class="text-xs font-bold text-primary mb-2 uppercase tracking-widest">03</span>
                        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-3">Hit Apply</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400 leading-relaxed px-4">Your transcription is
                            inserted right where your cursor was, ready to send or edit.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="py-24 bg-surface-light dark:bg-[#151515]" id="faq">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 text-gray-900 dark:text-white">Frequently Asked Questions
                </h2>
            </div>
            <div class="space-y-4">
                <details
                    class="group bg-white dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark cursor-pointer open:border-primary/50 dark:open:border-primary/50 transition-colors"
                    open>
                    <summary
                        class="flex justify-between items-center font-semibold text-lg list-none text-gray-900 dark:text-gray-100">
                        Is my voice data private?
                        <span
                            class="material-symbols-outlined transform group-open:rotate-180 transition-transform text-gray-400">expand_more</span>
                    </summary>
                    <p class="text-gray-600 dark:text-gray-400 mt-4 leading-relaxed">
                        Yes. You can choose to use local processing with Whisper models running entirely on your
                        machine. No audio ever leaves your computer.
                    </p>
                </details>
                <details
                    class="group bg-white dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark cursor-pointer open:border-primary/50 dark:open:border-primary/50 transition-colors">
                    <summary
                        class="flex justify-between items-center font-semibold text-lg list-none text-gray-900 dark:text-gray-100">
                        What apps does VoiceNote work in?
                        <span
                            class="material-symbols-outlined transform group-open:rotate-180 transition-transform text-gray-400">expand_more</span>
                    </summary>
                    <p class="text-gray-600 dark:text-gray-400 mt-4 leading-relaxed">
                        VoiceNote works in most applications where you can type, including email clients, browsers, chat
                        apps, docs, and forms.
                    </p>
                </details>
                <details
                    class="group bg-white dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark cursor-pointer open:border-primary/50 dark:open:border-primary/50 transition-colors">
                    <summary
                        class="flex justify-between items-center font-semibold text-lg list-none text-gray-900 dark:text-gray-100">
                        What languages are supported?
                        <span
                            class="material-symbols-outlined transform group-open:rotate-180 transition-transform text-gray-400">expand_more</span>
                    </summary>
                    <p class="text-gray-600 dark:text-gray-400 mt-4 leading-relaxed">
                        We support over 50 languages including English, Spanish, French, German, Chinese, and Japanese,
                        with auto-detection capabilities.
                    </p>
                </details>
                <details
                    class="group bg-white dark:bg-surface-dark p-6 rounded-xl border border-border-light dark:border-border-dark cursor-pointer open:border-primary/50 dark:open:border-primary/50 transition-colors">
                    <summary
                        class="flex justify-between items-center font-semibold text-lg list-none text-gray-900 dark:text-gray-100">
                        How does it perform on my hardware?
                        <span
                            class="material-symbols-outlined transform group-open:rotate-180 transition-transform text-gray-400">expand_more</span>
                    </summary>
                    <p class="text-gray-600 dark:text-gray-400 mt-4 leading-relaxed">
                        VoiceNote adaptively selects the best transcription model based on your hardware
                        configuration to
                        ensure optimal speed and accuracy without slowing down your system.
                    </p>
                </details>
            </div>
        </div>
    </section>
    <footer
        class="bg-background-light dark:bg-background-dark border-t border-border-light dark:border-border-dark py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
            <div class="flex items-center gap-2 justify-self-center md:justify-self-start">
                <img alt="VoiceNote logo" class="w-6 h-6 rounded object-cover" src="VoiceNote.ico" />
                <span class="font-bold text-gray-900 dark:text-white">VoiceNote</span>
            </div>
            <div class="flex w-full justify-center gap-8 text-sm text-gray-500 dark:text-gray-400 justify-self-center">
                <a class="hover:text-primary transition-colors" href="#">Privacy</a>
                <a class="hover:text-primary transition-colors" href="#">Terms</a>
            </div>
            <div class="text-xs text-gray-400 dark:text-gray-600 justify-self-center md:justify-self-end">
                © 2026 VoiceNote App. All rights reserved.
            </div>
        </div>
    </footer>
    <script>
        // Simple script to toggle dark mode for preview purposes if needed, 
        // though Tailwind's 'class' strategy relies on a parent class.
        // Assuming the environment this runs in allows toggling via system pref or a button not shown.
        // For this demo, we force dark mode on the html tag to match the prompt's main vibe, 
        // but the classes support both.
        document.documentElement.classList.add('dark');

        const featuresSection = document.getElementById('features');
        const workflowSection = document.getElementById('workflow');
        if (
            featuresSection &&
            workflowSection &&
            featuresSection.parentElement &&
            featuresSection.parentElement === workflowSection.parentElement
        ) {
            featuresSection.parentElement.insertBefore(workflowSection, featuresSection);
        }

        const downloadBtn = document.getElementById('download-windows-btn');
        if (downloadBtn) {
            downloadBtn.addEventListener('click', async (event) => {
                event.preventDefault();
                const fallbackUrl = 'https://github.com/schummelbaum/VoiceNote-builds/releases/latest';
                try {
                    const response = await fetch('https://api.github.com/repos/schummelbaum/VoiceNote-builds/releases/latest', {
                        headers: { 'Accept': 'application/vnd.github+json' },
                    });
                    if (!response.ok) throw new Error('Could not load latest release.');
                    const release = await response.json();
                    const assets = Array.isArray(release.assets) ? release.assets : [];
                    const preferredAsset =
                        assets.find((asset) => /\.exe$/i.test(asset.name)) ||
                        assets.find((asset) => /\.msi$/i.test(asset.name)) ||
                        assets.find((asset) => !/\.sha256$/i.test(asset.name));
                    const targetUrl = preferredAsset?.browser_download_url || release.html_url || fallbackUrl;
                    window.location.href = targetUrl;
                } catch (error) {
                    window.location.href = fallbackUrl;
                }
            });
        }

        const previewRoot = document.getElementById('vn-realistic-preview');
        if (previewRoot) {
            const previewRecordingLabel = document.getElementById('vn-preview-recording-label');
            const previewFlyoutTimer = document.getElementById('vn-preview-flyout-timer');
            const previewMicButton = document.getElementById('vn-preview-mic-button');
            const previewFlyoutFinish = document.getElementById('vn-preview-flyout-finish');
            const previewFlyoutDiscard = document.getElementById('vn-preview-flyout-discard');
            const previewSettingsButton = document.getElementById('vn-app-settings-button');
            const previewSettingsClose = document.getElementById('vn-settings-close-button');
            const previewSettingsOverlay = document.getElementById('vn-settings-overlay');
            let previewTimerId = null;
            let previewElapsedSeconds = 0;
            let previewTranscribingTimeoutId = null;
            const previewCombos = [];
            const previewWaveBars = Array.from(previewRoot.querySelectorAll('.vn-fly-wave-bar'));
            const previewSpinnerRoots = Array.from(previewRoot.querySelectorAll('.vn-mic-spinner, .vn-fly-spinner'));
            const clamp01 = (value) => Math.max(0, Math.min(1, Number(value) || 0));

            const createPreviewWaveformController = (bars) => {
                const DOT_COUNT = 12;
                const DOT_BASE_HEIGHT = 2;
                const DOT_MAX_HEIGHT = 14;
                const center = (DOT_COUNT - 1) * 0.5;
                const barLevels = new Array(DOT_COUNT).fill(0);
                let mode = 'idle';
                let phase = 0;
                let energy = 0;
                let lastAtMs = performance.now();

                const setMode = (nextMode) => {
                    mode = ['listening', 'transcribing'].includes(nextMode) ? nextMode : 'idle';
                    if (mode === 'transcribing') {
                        phase = 0;
                        energy = 0;
                        for (let i = 0; i < DOT_COUNT; i += 1) {
                            barLevels[i] = 0;
                        }
                    }
                };

                const render = () => {
                    if (!bars.length) {
                        return;
                    }
                    const idleColor = mode === 'transcribing'
                        ? [219, 228, 239, 0.62]
                        : [174, 174, 174, 0.56];
                    const activeColor = mode === 'transcribing'
                        ? [219, 228, 239, 0.98]
                        : [248, 86, 86, 0.95];

                    for (let i = 0; i < Math.min(DOT_COUNT, bars.length); i += 1) {
                        if (mode === 'transcribing') {
                            bars[i].style.height = `${DOT_BASE_HEIGHT}px`;
                            bars[i].style.backgroundColor = 'rgba(219, 228, 239, 0.95)';
                            continue;
                        }
                        const level = clamp01(barLevels[i]);
                        const height = Math.round(DOT_BASE_HEIGHT + (level * (DOT_MAX_HEIGHT - DOT_BASE_HEIGHT)));
                        const activity = mode === 'idle'
                            ? 0
                            : clamp01((level * 0.82) + (energy * 0.35));
                        const r = Math.round(idleColor[0] + ((activeColor[0] - idleColor[0]) * activity));
                        const g = Math.round(idleColor[1] + ((activeColor[1] - idleColor[1]) * activity));
                        const b = Math.round(idleColor[2] + ((activeColor[2] - idleColor[2]) * activity));
                        const a = idleColor[3] + ((activeColor[3] - idleColor[3]) * activity);
                        bars[i].style.height = `${Math.max(DOT_BASE_HEIGHT, Math.min(DOT_MAX_HEIGHT, height))}px`;
                        bars[i].style.backgroundColor = `rgba(${r}, ${g}, ${b}, ${a.toFixed(3)})`;
                    }
                };

                const frame = (nowMs) => {
                    const dtScale = Math.max(0.45, Math.min(2.0, (nowMs - lastAtMs) / 16.666));
                    lastAtMs = nowMs;
                    const nowSec = nowMs / 1000;

                    if (mode === 'transcribing') {
                        energy = 0;
                        render();
                        return;
                    }

                    if (mode === 'listening') {
                        const syllable = Math.max(0, Math.sin((nowSec * 10.8) + Math.sin(nowSec * 1.4)));
                        const phrase = 0.52 + (Math.sin((nowSec * 1.65) + 0.8) * 0.33);
                        const target = clamp01((0.16 + (syllable * 0.56) + (phrase * 0.34)) + ((Math.random() - 0.5) * 0.05));
                        energy += (target - energy) * (0.15 * dtScale);
                        phase += (0.13 + (energy * 0.14)) * dtScale;
                    } else {
                        energy += (0 - energy) * (0.13 * dtScale);
                    }

                    for (let i = 0; i < DOT_COUNT; i += 1) {
                        if (mode === 'idle') {
                            barLevels[i] += (0 - barLevels[i]) * (0.22 * dtScale);
                            continue;
                        }
                        const centerWeight = 1.0 - Math.min(1.0, Math.abs(i - center) / (center + 0.6));
                        const waveA = Math.sin((i * 0.92) - phase);
                        const waveB = Math.sin((i * 1.57) - (phase * 0.61) + 1.35);
                        const travel = ((waveA * 0.68) + (waveB * 0.32) + 1.0) * 0.5;
                        const floor = 0.06 + (centerWeight * 0.10);
                        const targetLevel = clamp01(floor + (travel * energy * (0.56 + (centerWeight * 0.44))));
                        barLevels[i] += (targetLevel - barLevels[i]) * (0.24 * dtScale);
                    }

                    render();
                };

                render();
                return { setMode, frame };
            };

            const createPreviewSpinnerController = (spinnerRoot) => {
                const spokes = Array.from(spinnerRoot.querySelectorAll('span'));
                const SPOKE_COUNT = 8;
                const PERIOD_MS = 900;
                const MIN_ALPHA = 0.26;
                const MAX_ALPHA = 0.98;
                const SPINNER_RGB = [219, 228, 239];
                let active = false;
                let startedAtMs = 0;

                const setSpoke = (spoke, alpha) => {
                    const clamped = clamp01(alpha);
                    const glow = clamp01((clamped - MIN_ALPHA) / (MAX_ALPHA - MIN_ALPHA));
                    spoke.style.backgroundColor = `rgba(${SPINNER_RGB[0]}, ${SPINNER_RGB[1]}, ${SPINNER_RGB[2]}, ${clamped.toFixed(3)})`;
                    spoke.style.boxShadow = glow > 0.02
                        ? `0 0 ${Math.round(6 + (glow * 3))}px rgba(${SPINNER_RGB[0]}, ${SPINNER_RGB[1]}, ${SPINNER_RGB[2]}, ${(0.10 + (glow * 0.24)).toFixed(3)})`
                        : 'none';
                };

                const setActive = (enabled) => {
                    const nextActive = !!enabled;
                    if (nextActive === active) {
                        return;
                    }
                    active = nextActive;
                    startedAtMs = nextActive ? performance.now() : 0;
                    if (!nextActive) {
                        for (const spoke of spokes) {
                            setSpoke(spoke, MIN_ALPHA * 0.9);
                        }
                    }
                };

                const frame = (nowMs) => {
                    if (!active || startedAtMs <= 0 || !spokes.length) {
                        return;
                    }
                    const progress = ((nowMs - startedAtMs) % PERIOD_MS) / PERIOD_MS;
                    const head = progress * SPOKE_COUNT;
                    for (let i = 0; i < spokes.length; i += 1) {
                        const trailingDistance = (head - i + SPOKE_COUNT) % SPOKE_COUNT;
                        const normalized = 1 - (trailingDistance / (SPOKE_COUNT - 1));
                        const eased = normalized <= 0
                            ? 0
                            : (normalized * normalized * (3 - (2 * normalized)));
                        const alpha = MIN_ALPHA + ((MAX_ALPHA - MIN_ALPHA) * eased);
                        setSpoke(spokes[i], alpha);
                    }
                };

                setActive(false);
                return { setActive, frame };
            };

            const previewWaveformController = createPreviewWaveformController(previewWaveBars);
            const previewSpinnerControllers = previewSpinnerRoots.map((spinnerRoot) => (
                createPreviewSpinnerController(spinnerRoot)
            ));

            const syncPreviewVisualAnimationState = (state, context) => {
                const waveformMode = context === 'flyout'
                    ? (state === 'listening' ? 'listening' : (state === 'transcribing' ? 'transcribing' : 'idle'))
                    : 'idle';
                previewWaveformController.setMode(waveformMode);
                const spinnerActive = state === 'transcribing';
                for (const controller of previewSpinnerControllers) {
                    controller.setActive(spinnerActive);
                }
            };

            const formatPreviewTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins}:${String(secs).padStart(2, '0')}`;
            };

            const stopPreviewClock = () => {
                if (previewTimerId) {
                    clearInterval(previewTimerId);
                    previewTimerId = null;
                }
            };

            const clearPreviewTranscribingTimeout = () => {
                if (previewTranscribingTimeoutId) {
                    clearTimeout(previewTranscribingTimeoutId);
                    previewTranscribingTimeoutId = null;
                }
            };

            const closeAllPreviewCombos = (exceptCombo = null) => {
                for (const combo of previewCombos) {
                    if (combo === exceptCombo) {
                        continue;
                    }
                    combo.classList.remove('open');
                    const button = combo.querySelector('.vn-setting-combo-button');
                    if (button) {
                        button.setAttribute('aria-expanded', 'false');
                    }
                }
            };

            const setupPreviewCombo = ({ comboId, buttonId, valueId, menuId }) => {
                const combo = document.getElementById(comboId);
                const button = document.getElementById(buttonId);
                const value = document.getElementById(valueId);
                const menu = document.getElementById(menuId);
                if (!combo || !button || !value || !menu) {
                    return;
                }
                const options = Array.from(menu.querySelectorAll('.vn-setting-combo-option'));

                const selectOption = (option) => {
                    if (!option) {
                        return;
                    }
                    for (const item of options) {
                        item.classList.toggle('is-selected', item === option);
                    }
                    value.textContent = option.textContent.trim();
                    combo.classList.remove('open');
                    button.setAttribute('aria-expanded', 'false');
                };

                button.addEventListener('click', () => {
                    const willOpen = !combo.classList.contains('open');
                    closeAllPreviewCombos(combo);
                    combo.classList.toggle('open', willOpen);
                    button.setAttribute('aria-expanded', willOpen ? 'true' : 'false');
                });

                for (const option of options) {
                    option.addEventListener('click', () => {
                        selectOption(option);
                    });
                }

                previewCombos.push(combo);
            };

            const setPreviewSettingsOpen = (open) => {
                previewRoot.classList.toggle('is-settings-open', !!open);
                if (!open) {
                    closeAllPreviewCombos();
                }
            };

            const startPreviewClock = () => {
                stopPreviewClock();
                previewElapsedSeconds = 0;
                const initialValue = formatPreviewTime(previewElapsedSeconds);
                if (previewRecordingLabel) {
                    previewRecordingLabel.textContent = initialValue;
                }
                if (previewFlyoutTimer) {
                    previewFlyoutTimer.textContent = initialValue;
                }
                previewTimerId = window.setInterval(() => {
                    previewElapsedSeconds += 1;
                    const value = formatPreviewTime(previewElapsedSeconds);
                    if (previewRecordingLabel) {
                        previewRecordingLabel.textContent = value;
                    }
                    if (previewFlyoutTimer) {
                        previewFlyoutTimer.textContent = value;
                    }
                }, 1000);
            };

            const contextItems = document.querySelectorAll('.vn-context-item');
            const demoAppBtn = document.getElementById('vn-demo-app-mode');
            const demoFlyoutBtn = document.getElementById('vn-demo-flyout-mode');

            const setPreviewState = (nextState, nextContext = null) => {
                const currentContext = nextContext || previewRoot.dataset.context || 'app';
                const normalizedState = ['idle', 'listening', 'transcribing', 'settings'].includes(nextState) ? nextState : 'idle';

                clearPreviewTranscribingTimeout();
                previewRoot.dataset.state = normalizedState;
                previewRoot.dataset.context = currentContext;
                syncPreviewVisualAnimationState(normalizedState, currentContext);

                // Robust Display Logic: Clear EVERYTHING first, then re-apply active state
                // This prevents state overlap bugs
                const allItems = Array.from(contextItems); // Static snapshot

                allItems.forEach(item => {
                    item.classList.remove('is-active');
                    // Force a tiny style change to trigger reflow if needed, though class removal usually suffices
                    item.style.display = 'none';
                    item.offsetHeight; // Force reflow
                    item.style.display = '';
                });

                requestAnimationFrame(() => {
                    allItems.forEach(item => {
                        const itemContext = item.dataset.context;
                        const itemState = item.dataset.state;

                        let isActive = false;

                        if (itemContext === currentContext) {
                            if (itemState === normalizedState) {
                                isActive = true;
                            }
                            // Special Case: Flyout doesn't have an explicit 'idle' UI state, so show 'listening' (intro)
                            if (currentContext === 'flyout' && normalizedState === 'idle' && itemState === 'listening') {
                                isActive = true;
                            }
                        }

                        if (isActive) {
                            item.classList.add('is-active');
                        }
                    });
                });

                // Update Demo Buttons
                if (demoAppBtn && demoFlyoutBtn) {
                    demoAppBtn.classList.toggle('is-active', currentContext === 'app');
                    demoFlyoutBtn.classList.toggle('is-active', currentContext === 'flyout');
                }

                if (normalizedState === 'listening') {
                    startPreviewClock();
                    return;
                }

                stopPreviewClock();
                if (normalizedState === 'transcribing') {
                    if (previewRecordingLabel) {
                        previewRecordingLabel.textContent = 'Transcribing';
                    }
                    if (previewFlyoutTimer) {
                        previewFlyoutTimer.textContent = '0:00';
                    }
                    previewTranscribingTimeoutId = window.setTimeout(() => {
                        if (currentContext === 'flyout') {
                            setPreviewState('listening', 'flyout');
                            return;
                        }
                        setPreviewState('idle', currentContext);
                    }, 1500); // Slightly longer for reading
                    return;
                }

                if (previewRecordingLabel) {
                    previewRecordingLabel.textContent = 'Tap to record';
                }
                if (previewFlyoutTimer) {
                    previewFlyoutTimer.textContent = '0:00';
                }
            };

            if (previewMicButton) {
                previewMicButton.addEventListener('click', () => {
                    const current = previewRoot.dataset.state || 'idle';
                    // Mic button forces App context
                    if (current === 'idle') {
                        setPreviewState('listening', 'app');
                    } else if (current === 'listening') {
                        setPreviewState('transcribing', 'app');
                    }
                });
            }

            if (previewFlyoutFinish) {
                previewFlyoutFinish.addEventListener('click', () => {
                    setPreviewState('transcribing', 'flyout');
                });
            }

            if (previewFlyoutDiscard) {
                previewFlyoutDiscard.addEventListener('click', () => {
                    // Do nothing - User override for demo purpose
                    // setPreviewState('idle', 'flyout');
                });
            }

            if (previewSettingsButton) {
                previewSettingsButton.addEventListener('click', () => {
                    const isOpen = !previewRoot.classList.contains('is-settings-open');
                    setPreviewSettingsOpen(isOpen);
                    if (isOpen) {
                        setPreviewState('settings', 'app');
                    } else {
                        setPreviewState('idle', 'app');
                    }
                });
            }
            if (previewSettingsClose) {
                previewSettingsClose.addEventListener('click', () => {
                    setPreviewSettingsOpen(false);
                    setPreviewState('idle', 'app');
                });
            }
            if (previewSettingsOverlay) {
                previewSettingsOverlay.addEventListener('click', () => {
                    setPreviewSettingsOpen(false);
                    setPreviewState('idle', 'app');
                });
            }

            // Demo Mode Toggles
            if (demoAppBtn) {
                demoAppBtn.addEventListener('click', () => {
                    setPreviewState('idle', 'app');
                });
            }
            if (demoFlyoutBtn) {
                demoFlyoutBtn.addEventListener('click', () => {
                    // Start flyout in listening mode immediately to simulate hotkey
                    setPreviewState('listening', 'flyout');
                });
            }

            setupPreviewCombo({
                comboId: 'vn-setting-language-combo',
                buttonId: 'vn-setting-language-button',
                valueId: 'vn-setting-language-value',
                menuId: 'vn-setting-language-menu',
            });
            setupPreviewCombo({
                comboId: 'vn-setting-model-combo',
                buttonId: 'vn-setting-model-button',
                valueId: 'vn-setting-model-value',
                menuId: 'vn-setting-model-menu',
            });
            setupPreviewCombo({
                comboId: 'vn-setting-close-action-combo',
                buttonId: 'vn-setting-close-action-button',
                valueId: 'vn-setting-close-action-value',
                menuId: 'vn-setting-close-action-menu',
            });

            document.addEventListener('click', (event) => {
                if (!(event.target instanceof Element)) {
                    return;
                }
                const insideCombo = event.target.closest('.vn-setting-combo');
                if (!insideCombo) {
                    closeAllPreviewCombos();
                }
            });

            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    closeAllPreviewCombos();
                }
            });

            const runPreviewMotionFrame = (nowMs) => {
                previewWaveformController.frame(nowMs);
                for (const controller of previewSpinnerControllers) {
                    controller.frame(nowMs);
                }
                window.requestAnimationFrame(runPreviewMotionFrame);
            };
            window.requestAnimationFrame(runPreviewMotionFrame);

            setPreviewState('idle', 'app');
        }
    </script>
</body>

</html>
